version: "3.7"

services:
  forest_calibnet:
    image: ghcr.io/chainsafe/forest:${FOREST_TAG}
    hostname: forest-calibnet
    container_name: forest-calibnet
    volumes:
      - type: bind
        source: ${BASE_FOLDER}
        target: ${BASE_FOLDER}
    entrypoint: ["/bin/bash", "-c"]
    environment:
      - SLACK_HOOK
    command:
      - |
        export CHAIN_NAME=calibnet
        $BASE_FOLDER/upload_snapshot.sh
    restart: on-failure
    labels:
      com.centurylinklabs.watchtower.enable: true
  watchtower:
    image: containrrr/watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    command: --label-enable --include-stopped --interval 3600
    restart: unless-stopped
